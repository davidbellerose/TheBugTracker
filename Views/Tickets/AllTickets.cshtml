@model IEnumerable<TheBugTracker.Models.Ticket>

@using TheBugTracker.Services.Interfaces
@using TheBugTracker.Models.Enums
@using Microsoft.AspNetCore.Identity

@inject UserManager<BTUser> UserManager
@inject IBTProjectService ProjectService

@{
    ViewData["Title"] = "All Tickets";
    BTUser bTUser = await UserManager.GetUserAsync(User);
}

<h1>All Tickets</h1>


<div class="tickets-container">
    <ul class="responsive-table">
        <li class="table-header">
            <div class="col col-1">Title</div>
            <div class="col col-2">Developer</div>
            <div class="col col-3">Status</div>
            <div class="col col-4">Priority</div>
            <div class="col col-4">Date</div>
            <div class="col col-4"></div>
        </li>
        @foreach (var ticket in Model.OrderByDescending(d => d.Created))
        {
            <li class="table-row">
                <div class="col col-1" data-label="Ticket">
                    <a asp-action="Details" asp-controller="Tickets" asp-route-id="@ticket.Id" style="color:black"><strong>@ticket.Title</strong></a>
                </div>
                <div class="col col-2" data-label="Developer">
                    @if (ticket.DeveloperUserId != null)
                    {
                        @ticket.DeveloperUser?.FullName
                    }
                    else
                    {
                        <span><strong><em class="text-warning">Unassigned</em></strong></span>
                    }
                </div>
                @* TICKET STATUS *@
                @if (ticket.TicketStatus.Name == "New")
                {
                    <div class="col col-3" data-label="Ticket Status"><span class="badge-new">@ticket.TicketStatus.Name</span></div>
                }
                else if (ticket.TicketStatus.Name == "Development")
                {
                    <div class="col col-3" data-label="Ticket Status"><span class="badge-development">@ticket.TicketStatus.Name</span></div>

                }
                else if (ticket.TicketStatus.Name == "Testing")
                {
                    <div class="col col-3" data-label="Ticket Status"><span class="badge-testing">@ticket.TicketStatus.Name</span></div>

                }
                else if (ticket.TicketStatus.Name == "Resolved")
                {
                    <div class="col col-3" data-label="Ticket Status"><span class="badge-resolved">@ticket.TicketStatus.Name</span></div>
                }
                @* TICKET PRIORITY *@
                @if (@ticket.TicketPriority.Name == "Low")
                {
                    <div class="col col-4" data-label="Ticket Status"><span class="badge-low">@ticket.TicketPriority.Name</span></div>
                }
                else if (@ticket.TicketPriority.Name == "Medium")
                {
                    <div class="col col-4" data-label="Ticket Status"><span class="badge-medium">@ticket.TicketPriority.Name</span></div>

                }
                else if (@ticket.TicketPriority.Name == "High")
                {
                    <div class="col col-4" data-label="Ticket Status"><span class="badge-high">@ticket.TicketPriority.Name</span></div>

                }
                else if (@ticket.TicketPriority.Name == "Urgent")
                {
                    <div class="col col-4" data-label="Ticket Status"><span class="badge-urgent">@ticket.TicketPriority.Name</span></div>
                }
                <div class="col col-5" data-label="Date">@ticket.Created.ToString("MM/dd/yyyy")</div>
                <div class="col col-6" data-label="">
                    <a class="" asp-action="Details" asp-controller="Tickets" asp-route-id="@ticket.Id">
                        <i class="bi bi-eye-fill"></i>
                    </a>
                </div>
            </li>
        }
    </ul>
</div>